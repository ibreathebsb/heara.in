{"data":{"site":{"siteMetadata":{"title":"Heara.in","author":"Isaac Young"}},"markdownRemark":{"id":"55d229ca-8d59-5f7f-90c1-31ed6c652f08","html":"<!-- more -->\n<h2 id=\"initial\"><a href=\"#initial\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>initial</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// webpack.config.js</span>\noptimization<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    runtimeChunk<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'runtime'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    splitChunks<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      chunks<span class=\"token punctuation\">:</span> <span class=\"token string\">'initial'</span><span class=\"token punctuation\">,</span>\n      minSize<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      automaticNameDelimiter<span class=\"token punctuation\">:</span> <span class=\"token string\">'.'</span><span class=\"token punctuation\">,</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">initial</code> 初始chunk指的是会在我们页面中会议script标签进行引用的chunk,在这里理解为<code class=\"language-text\">entry point</code>更加合理。当chunks的值被设置为<code class=\"language-text\">initial</code>时，<code class=\"language-text\">webpack</code>会从几个<code class=\"language-text\">entry point</code>寻找共同的chunk并将它们抽离出来。</p>\n<p>一个示例：</p>\n<p>三个子模块<code class=\"language-text\">a.js</code>,<code class=\"language-text\">b.js</code>,<code class=\"language-text\">c.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// a.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">a</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// b.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">b</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// c.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">c</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>三个入口文件 <code class=\"language-text\">x.js</code>,<code class=\"language-text\">y.js</code>,<code class=\"language-text\">z.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// x.js</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> a <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./a'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> b <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./b'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> c <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./c'</span>\n\n<span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">b</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">c</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// y.js</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> b <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./b'</span>\n<span class=\"token function\">b</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//z.js</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> c <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./c'</span>\n<span class=\"token function\">c</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>打包结果</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Version: webpack 4.19.0\nTime: 769ms\nBuilt at: 2018-09-17 21:45:29\n                      Asset       Size   Chunks             Chunk Names\n                 runtime.js   6.04 KiB  runtime  [emitted]  runtime\n  x.52298057ad794c677ad0.js   1.29 KiB        x  [emitted]  x\nx.y.4a4994beef749c762b94.js  399 bytes      x.y  [emitted]  x.y\nx.z.0217d5fc8ef98d66c601.js  394 bytes      x.z  [emitted]  x.z\n  y.b7f3cafb712c77184370.js  716 bytes        y  [emitted]  y\n  z.9dfc882705cf30b10fc2.js  716 bytes        z  [emitted]  z\n                 index.html  684 bytes           [emitted]\nEntrypoint x = runtime.js x.y.4a4994beef749c762b94.js x.z.0217d5fc8ef98d66c601.js x.52298057ad794c677ad0.js\nEntrypoint y = runtime.js x.y.4a4994beef749c762b94.js y.b7f3cafb712c77184370.js\nEntrypoint z = runtime.js x.z.0217d5fc8ef98d66c601.js z.9dfc882705cf30b10fc2.js\n[./src/a.js] 59 bytes {x} [built]\n[./src/b.js] 64 bytes {x.y} [built]\n[./src/c.js] 59 bytes {x.z} [built]\n[./src/x.js] 396 bytes {x} [built]\n[./src/y.js] 336 bytes {y} [built]\n[./src/z.js] 336 bytes {z} [built]</code></pre></div>\n<p>结果分析:</p>\n<p>共生成了6个文件：</p>\n<ul>\n<li><code class=\"language-text\">runtime</code>:  webpack的模块加载系统</li>\n<li><code class=\"language-text\">x</code>, <code class=\"language-text\">y</code>, <code class=\"language-text\">z</code> : 分别对应着三个入口文件</li>\n<li><code class=\"language-text\">x.y</code>，<code class=\"language-text\">x.z</code>： 分别是<code class=\"language-text\">x</code>和<code class=\"language-text\">y</code>的公共chunk，<code class=\"language-text\">x</code>和<code class=\"language-text\">z</code>的公共chunk</li>\n</ul>\n<p>由于<code class=\"language-text\">x</code>和<code class=\"language-text\">y</code>共享模块<code class=\"language-text\">b</code>，<code class=\"language-text\">b</code>就被提取出来单独打包了<code class=\"language-text\">x.y</code>里面,查看下<code class=\"language-text\">x.y</code>里面的内容:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// x.y.4a4994beef749c762b94.js</span>\n\n<span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">[</span><span class=\"token string\">\"webpackJsonp\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> window<span class=\"token punctuation\">[</span><span class=\"token string\">\"webpackJsonp\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"x.y\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token string\">\"./src/b.js\"</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>module<span class=\"token punctuation\">,</span> __webpack_exports__<span class=\"token punctuation\">,</span> __webpack_require__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n__webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">r</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/* harmony export (binding) */</span> __webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> b<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">b</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">b</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">// &lt;= 我们的b模块就是这里啦</span>\n  <span class=\"token keyword\">return</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"async\"><a href=\"#async\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>async</h2>\n<p><code class=\"language-text\">async</code>就比较好理解了，值对使用动态导入语法<code class=\"language-text\">import()</code>的chunk进行分割</p>\n<p>直接上例子：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// webpack.config.js</span>\noptimization<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    runtimeChunk<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'runtime'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    splitChunks<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      chunks<span class=\"token punctuation\">:</span> <span class=\"token string\">'async'</span><span class=\"token punctuation\">,</span>\n      minSize<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      automaticNameDelimiter<span class=\"token punctuation\">:</span> <span class=\"token string\">'.'</span><span class=\"token punctuation\">,</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// x.js</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> b <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./b'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> c <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./c'</span>\n\n<span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* webpackChunkName: 'a' */</span> <span class=\"token string\">'./a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>a<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">b</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">c</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>打包结果</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Hash: 6e7ab31c75d5547d92b2\nVersion: webpack 4.19.0\nTime: 622ms\nBuilt at: 2018-09-17 23:07:49\n                    Asset       Size   Chunks             Chunk Names\na.fff072717b457054e2ec.js  392 bytes        a  [emitted]  a\n               runtime.js   8.81 KiB  runtime  [emitted]  runtime\nx.4347b3a6f9f051c2b383.js   1.34 KiB        x  [emitted]  x\ny.d2cbbe1d653124bf3547.js  726 bytes        y  [emitted]  y\nz.e8b91a3f2a23c5bce4fc.js  721 bytes        z  [emitted]  z\n               index.html  536 bytes           [emitted]\nEntrypoint x = runtime.js x.4347b3a6f9f051c2b383.js\nEntrypoint y = runtime.js y.d2cbbe1d653124bf3547.js\nEntrypoint z = runtime.js z.e8b91a3f2a23c5bce4fc.js\n[./src/a.js] 59 bytes {a} [built]\n[./src/b.js] 64 bytes {x} {y} [built]\n[./src/c.js] 59 bytes {x} {z} [built]\n[./src/x.js] 188 bytes {x} [built]\n[./src/y.js] 29 bytes {y} [built]\n[./src/z.js] 29 bytes {z} [built]</code></pre></div>\n<p>可以看出尽管<code class=\"language-text\">x</code>和<code class=\"language-text\">y</code>, <code class=\"language-text\">x</code>和<code class=\"language-text\">z</code>都有公共部分,但只有异步导入的<code class=\"language-text\">a</code>模块被单独构建出来,<code class=\"language-text\">b</code>和<code class=\"language-text\">c</code>的代码存在重复：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// a.fff072717b457054e2ec.js</span>\n<span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">[</span><span class=\"token string\">\"webpackJsonp\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> window<span class=\"token punctuation\">[</span><span class=\"token string\">\"webpackJsonp\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token string\">\"./src/a.js\"</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>module<span class=\"token punctuation\">,</span> __webpack_exports__<span class=\"token punctuation\">,</span> __webpack_require__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n__webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">r</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/* harmony export (binding) */</span> __webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> a<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// x.4347b3a6f9f051c2b383.js</span>\n\n<span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">[</span><span class=\"token string\">\"webpackJsonp\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> window<span class=\"token punctuation\">[</span><span class=\"token string\">\"webpackJsonp\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token string\">\"./src/b.js\"</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>module<span class=\"token punctuation\">,</span> __webpack_exports__<span class=\"token punctuation\">,</span> __webpack_require__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n__webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">r</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/* harmony export (binding) */</span> __webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> b<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">b</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">b</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token string\">\"./src/c.js\"</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>module<span class=\"token punctuation\">,</span> __webpack_exports__<span class=\"token punctuation\">,</span> __webpack_require__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n__webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">r</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/* harmony export (binding) */</span> __webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">,</span> <span class=\"token string\">\"c\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> c<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">c</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">c</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token string\">\"./src/x.js\"</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>module<span class=\"token punctuation\">,</span> __webpack_exports__<span class=\"token punctuation\">,</span> __webpack_require__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n__webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">r</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/* harmony import */</span> <span class=\"token keyword\">var</span> _b__WEBPACK_IMPORTED_MODULE_0__ <span class=\"token operator\">=</span> <span class=\"token function\">__webpack_require__</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./src/b.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/* harmony import */</span> <span class=\"token keyword\">var</span> _c__WEBPACK_IMPORTED_MODULE_1__ <span class=\"token operator\">=</span> <span class=\"token function\">__webpack_require__</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./src/c.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// import { a } from './a'</span>\n\n\n__webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">e</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* import() | a */</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>__webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"./src/a.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>_ref<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> _ref<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">Object</span><span class=\"token punctuation\">(</span>_b__WEBPACK_IMPORTED_MODULE_0__<span class=\"token punctuation\">[</span><span class=\"token string\">\"b\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">Object</span><span class=\"token punctuation\">(</span>_c__WEBPACK_IMPORTED_MODULE_1__<span class=\"token punctuation\">[</span><span class=\"token string\">\"c\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"./src/x.js\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"runtime\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// y.d2cbbe1d653124bf3547.js</span>\n\n<span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">[</span><span class=\"token string\">\"webpackJsonp\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> window<span class=\"token punctuation\">[</span><span class=\"token string\">\"webpackJsonp\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"y\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token string\">\"./src/b.js\"</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>module<span class=\"token punctuation\">,</span> __webpack_exports__<span class=\"token punctuation\">,</span> __webpack_require__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n__webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">r</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/* harmony export (binding) */</span> __webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> b<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">b</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">b</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token string\">\"./src/y.js\"</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>module<span class=\"token punctuation\">,</span> __webpack_exports__<span class=\"token punctuation\">,</span> __webpack_require__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n__webpack_require__<span class=\"token punctuation\">.</span><span class=\"token function\">r</span><span class=\"token punctuation\">(</span>__webpack_exports__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/* harmony import */</span> <span class=\"token keyword\">var</span> _b__WEBPACK_IMPORTED_MODULE_0__ <span class=\"token operator\">=</span> <span class=\"token function\">__webpack_require__</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./src/b.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">Object</span><span class=\"token punctuation\">(</span>_b__WEBPACK_IMPORTED_MODULE_0__<span class=\"token punctuation\">[</span><span class=\"token string\">\"b\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/***/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"./src/y.js\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"runtime\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>可以看出<code class=\"language-text\">x</code>和<code class=\"language-text\">y</code>的bundle里面<code class=\"language-text\">b</code>的代码重复了，不过这就是<code class=\"language-text\">async</code>模式的特点：只处理<code class=\"language-text\">import()</code></p>\n<h2 id=\"all\"><a href=\"#all\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>all</h2>\n<p><code class=\"language-text\">all</code> 不管什么chunk类型，符合配置条件的全部抽出来</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Version: webpack 4.19.0\nTime: 606ms\nBuilt at: 2018-09-17 23:17:16\n                      Asset       Size   Chunks             Chunk Names\n  a.fff072717b457054e2ec.js  392 bytes        a  [emitted]  a\n                 runtime.js   8.81 KiB  runtime  [emitted]  runtime\n  x.eb5392750ad2fc843d72.js  741 bytes        x  [emitted]  x\nx.y.4a4994beef749c762b94.js  399 bytes      x.y  [emitted]  x.y\nx.z.0217d5fc8ef98d66c601.js  394 bytes      x.z  [emitted]  x.z\n  y.a10abf98f5dd5604c717.js  409 bytes        y  [emitted]  y\n  z.3c6fb959ec0f195c66d2.js  409 bytes        z  [emitted]  z\n                 index.html  684 bytes           [emitted]\nEntrypoint x = runtime.js x.y.4a4994beef749c762b94.js x.z.0217d5fc8ef98d66c601.js x.eb5392750ad2fc843d72.js\nEntrypoint y = runtime.js x.y.4a4994beef749c762b94.js y.a10abf98f5dd5604c717.js\nEntrypoint z = runtime.js x.z.0217d5fc8ef98d66c601.js z.3c6fb959ec0f195c66d2.js\n[./src/a.js] 59 bytes {a} [built]\n[./src/b.js] 64 bytes {x.y} [built]\n[./src/c.js] 59 bytes {x.z} [built]\n[./src/x.js] 188 bytes {x} [built]\n[./src/y.js] 29 bytes {y} [built]\n[./src/z.js] 29 bytes {z} [built]</code></pre></div>\n<p>可以看出<code class=\"language-text\">a</code> <code class=\"language-text\">x.y</code> <code class=\"language-text\">x.z</code>均被单独打包出来、</p>\n<h2 id=\"最后\"><a href=\"#%E6%9C%80%E5%90%8E\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>最后</h2>\n<p>以上就是三种模式的区别，比较常用的还是<code class=\"language-text\">all</code>，后面打算写一下<code class=\"language-text\">runtime</code>的工作原理,敬请期待！</p>","timeToRead":6,"frontmatter":{"title":"理解webpack4中splitChunks的3种模式","date":"September 17, 2018","spoiler":"今天聊一聊webpack4中的splitChunks的3中模式 `initial` `async` `all`"},"fields":{"slug":"/splitchunks-in-webpack4/"}}},"pageContext":{"slug":"/splitchunks-in-webpack4/","previous":{"fields":{"slug":"/build-a-node-cli/从零开始创建一个node-cli/","directoryName":"build-a-node-cli"},"frontmatter":{"title":"从零开始创建一个node-cli"}},"next":{"fields":{"slug":"/how-does-react-tell-a-class-from-a-function/","directoryName":"how-does-react-tell-a-class-from-a-function"},"frontmatter":{"title":"React 如何区分 Class 和 Function？"}}}}